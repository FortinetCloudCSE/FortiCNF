<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.111.3"><meta name=generator content="Relearn 5.12.6+tip"><meta name=description content="FortiGate CNF Workshop"><meta name=author content="Hiruy Aberra"><title>AWS Common Architecture Patterns - FortiGate CNF Workshop</title><link href=../2_moduletwo/23_awscommonarchitecturepatterns/index.xml rel=alternate type=application/rss+xml title="AWS Common Architecture Patterns - FortiGate CNF Workshop"><link rel=icon href=https://www.fortinet.com/etc/designs/fortinet/favicon.ico type=image/x-icon><link href=../css/fontawesome-all.min.css?1684355376 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fontawesome-all.min.css?1684355376 rel=stylesheet></noscript><link href=../css/nucleus.css?1684355376 rel=stylesheet><link href=../css/auto-complete.css?1684355376 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/auto-complete.css?1684355376 rel=stylesheet></noscript><link href=../css/perfect-scrollbar.min.css?1684355376 rel=stylesheet><link href=../css/fonts.css?1684355376 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fonts.css?1684355376 rel=stylesheet></noscript><link href=../css/theme.css?1684355376 rel=stylesheet><link href=../css/theme-Fortinet.css?1684355376 rel=stylesheet id=variant-style><link href=../css/variant.css?1684355376 rel=stylesheet><link href=../css/print.css?1684355376 rel=stylesheet media=print><link href=../css/ie.css?1684355376 rel=stylesheet><script src=../js/url.js?1684355376></script>
<script src=../js/variant.js?1684355376></script>
<script>window.index_json_url="../index.json",window.index_js_url="../index.search.js";var root_url="../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://fortinetcloudcse.github.io/FortiCNF/",window.variants&&variants.init(["Fortinet"])</script><style>@media screen and (min-width:1300px){#body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1300px;width:100%}}</style></head><body class="mobile-support html" data-url=../2_moduletwo/23_awscommonarchitecturepatterns.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next topbar-link" href=../2_moduletwo/24_fortigatecnfterminology.html title="FortiGate CNF Terminology (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev topbar-link" href=../2_moduletwo/22_awsnetworkingconcepts.html title="AWS Networking Concepts (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle class=topbar-link title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../index.html><span itemprop=name>Secure AWS workloads with FortiGate CNF SaaS</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../2_moduletwo.html><span itemprop=name>Workshop Prerequisites</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>AWS Common Architecture Patterns</span><meta itemprop=position content="3"></li></ol></div></div></nav><main id=body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><div id=head-tags></div><article class="chapter deprecated"><h1 id=aws-common-architecture-patterns>AWS Common Architecture Patterns</h1><p>While there are many ways to organize your infrastructure there are two main ways to design your networking when using GWLB, centralized and distributed. From the perspective of networking, routing, and GWLBe placement. We will discuss this further below.</p><p>FortiGate CNF is a SaaS offering that on the backend uses FortiGates, AWS GWLB, and GWLB endpoints to intercept customer traffic and inspect this transparently. As part of the deployment process for FortiGate CNF instances, the customer environment will need to implement VPC and ingress routing at the IGW to intercept the traffic to be inspected.</p><p>The FortiGate CNF security stack which includes the AWS GWLB and other components will be deployed in Fortinet managed AWS accounts. The details of the diagram are simply an example of the main components used in FortiGate CNF. This is more to understand what happens when customer traffic is received at our GWLB.</p><p><a href=#image-6a95977b84b4a35f198b8c96cc9fa237 class=lightbox-link><img src=../images/image-cap-1.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-6a95977b84b4a35f198b8c96cc9fa237><img src=../images/image-cap-1.png alt class=lightbox-image loading=lazy></a></p><p>Decentralized designs do not require any routing between the protected VPC and another VPC through TGW. These designs allow simple service insertion with minimal routing changes to the VPC route table. The <strong>yellow numbers</strong> show the initial packet flow for a session and how it is routed (using ingress and VPC routes) to the GWLBe endpoint which then sends traffic to the FortiGate CNF stack. The <strong>blue numbers</strong> show the returned traffic after inspection by the FortiGate CNF stack.</p><p><strong>Note:</strong> Any subnet where the GWLBe for the FortiGate CNF instance is to be deployed will need to have a specific tag name and value to be seen in the FortiGate CNF portal. Currently this is the tag name &lsquo;<strong>fortigatecnf_subnet_type</strong>&rsquo; and tag value &lsquo;<strong>endpoint</strong>&rsquo;.</p><p><a href=#image-64d6030ca37287ea37de235efc92b98f class=lightbox-link><img src=../images/image-cap-2.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-64d6030ca37287ea37de235efc92b98f><img src=../images/image-cap-2.png alt class=lightbox-image loading=lazy></a></p><p><a href=#image-47437b79aeae019132798fcb0070480e class=lightbox-link><img src=../images/image-cap-3.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-47437b79aeae019132798fcb0070480e><img src=../images/image-cap-3.png alt class=lightbox-image loading=lazy></a></p><p><a href=#image-8fbbaacdd8a19102e8dc7624b0526491 class=lightbox-link><img src=../images/image-cap-4.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-8fbbaacdd8a19102e8dc7624b0526491><img src=../images/image-cap-4.png alt class=lightbox-image loading=lazy></a></p><p><a href=#image-499d14d6726fadf1e86421ecb54089fb class=lightbox-link><img src=../images/image-cap-5.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-499d14d6726fadf1e86421ecb54089fb><img src=../images/image-cap-5.png alt class=lightbox-image loading=lazy></a></p><p>Centralized designs require the use of TGW to provide a simple hub and spoke architecture to inspect traffic. These can simplify east-west and egress traffic inspection needs while removing the need for IGWs and NAT Gateways to be deployed in each protected VPC for egress inspection. You can still mix a decentralized architecture to inspect ingress and even egress traffic while leveraging the centralized design for all east-west inspection.</p><p>The <strong>yellow numbers</strong> show the initial packet flow for a session and how it is routed (using ingress, VPC routes, and TGW routes) to the GWLBe which then sends traffic to the FortiGate CNF stack. The <strong>blue numbers (east-west)</strong> and <strong>purple numbers (egress)</strong> show the returned traffic after inspection by the FortiGate CNF stack.</p><p><a href=#image-7e8496c9273b4bf64993326441226ee1 class=lightbox-link><img src=../images/image-cap-6.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-7e8496c9273b4bf64993326441226ee1><img src=../images/image-cap-6.png alt class=lightbox-image loading=lazy></a></p><p><a href=#image-a66091e3ad3cdcec13b69c69a43d6e39 class=lightbox-link><img src=../images/image-cap-7.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-a66091e3ad3cdcec13b69c69a43d6e39><img src=../images/image-cap-7.png alt class=lightbox-image loading=lazy></a></p><p><a href=#image-f9574215574d08d74620606370b0eb66 class=lightbox-link><img src=../images/image-cap-8.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-f9574215574d08d74620606370b0eb66><img src=../images/image-cap-8.png alt class=lightbox-image loading=lazy></a></p><p>For more examples of distributed and centralized models, please reference the examples on the <a href=https://docs.fortinet.com/document/fortigate-cnf/latest/administration-guide/325439/deployment-scenarios target=_blank><strong>FortiGate CNF Admin Guide</strong></a>.</p><footer class=footline></footer></article></div></main></div><aside id=sidebar class="default-animation showVisitedLinks"><div id=header-wrapper class=default-animation><div id=header class=default-animation><a href=../ title="Fortinet Demos"><img style=vertical-align:middle src=../Fortinet-logo-rgb-white-red.svg height=70px></a></div><form action=../search.html method=get><div class="searchbox default-animation"><button type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=search-by>Search</label>
<input data-search-input id=search-by name=search-by class=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div></form><script>var contentLangs=["en"]</script><script src=../js/auto-complete.js?1684355376 defer></script>
<script src=../js/lunr/lunr.min.js?1684355376 defer></script>
<script src=../js/lunr/lunr.stemmer.support.min.js?1684355376 defer></script>
<script src=../js/lunr/lunr.multi.min.js?1684355376 defer></script>
<script src=../js/lunr/lunr.en.min.js?1684355376 defer></script>
<script src=../js/search.js?1684355376 defer></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=../index.html><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class="topics enlarge morespace collapsible-menu"><li data-nav-id=/1_moduleone.html><a class=padding href=../1_moduleone.html>Introduction<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo.html class=parent><input type=checkbox id=section-6180d618e477c4171cc9d7ced5bb0928 aria-controls=subsections-6180d618e477c4171cc9d7ced5bb0928 checked><label for=section-6180d618e477c4171cc9d7ced5bb0928><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Workshop Prerequisites</span></label><a class=padding href=../2_moduletwo.html>Workshop Prerequisites<i class="fas fa-check read-icon"></i></a><ul id=subsections-6180d618e477c4171cc9d7ced5bb0928 class="morespace collapsible-menu"><li data-nav-id=/2_moduletwo/21_logistics.html><a class=padding href=../2_moduletwo/21_logistics.html>Workshop Logistics<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo/22_awsnetworkingconcepts.html><a class=padding href=../2_moduletwo/22_awsnetworkingconcepts.html>AWS Networking Concepts<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo/23_awscommonarchitecturepatterns.html class=active><a class=padding href=../2_moduletwo/23_awscommonarchitecturepatterns.html>AWS Common Architecture Patterns<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo/24_fortigatecnfterminology.html><a class=padding href=../2_moduletwo/24_fortigatecnfterminology.html>FortiGate CNF Terminology<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/3_modulethree.html><input type=checkbox id=section-787a272b0074b57237733dd429c6920c aria-controls=subsections-787a272b0074b57237733dd429c6920c><label for=section-787a272b0074b57237733dd429c6920c><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Workshop Hands On</span></label><a class=padding href=../3_modulethree.html>Workshop Hands On<i class="fas fa-check read-icon"></i></a><ul id=subsections-787a272b0074b57237733dd429c6920c class="morespace collapsible-menu"><li data-nav-id=/3_modulethree/31_task1.html><a class=padding href=../3_modulethree/31_task1.html>Task 1: Subscribe to FortiGate CNF in AWS Marketplace<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/32_task2.html><a class=padding href=../3_modulethree/32_task2.html>Task 2: Onboard an AWS account to FortiGate CNF<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/33_task3.html><a class=padding href=../3_modulethree/33_task3.html>Task 3: Deploying CNF Instances and GWLBe endpoints<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/34_task4.html><a class=padding href=../3_modulethree/34_task4.html>Task 4: Create a policy set and apply it to a FortiGate CNF Instance<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/35_task5.html><a class=padding href=../3_modulethree/35_task5.html>Task 5: Validate Resolution of Dynamic Address Objects<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4_modulefour.html><input type=checkbox id=section-e0da539b16e47ab0661df6a76b214530 aria-controls=subsections-e0da539b16e47ab0661df6a76b214530><label for=section-e0da539b16e47ab0661df6a76b214530><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Workshop Test Traffic</span></label><a class=padding href=../4_modulefour.html>Workshop Test Traffic<i class="fas fa-check read-icon"></i></a><ul id=subsections-e0da539b16e47ab0661df6a76b214530 class="morespace collapsible-menu"><li data-nav-id=/4_modulefour/41_distributedingress.html><a class=padding href=../4_modulefour/41_distributedingress.html>Distributed Ingress<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4_modulefour/42_distributedegress.html><a class=padding href=../4_modulefour/42_distributedegress.html>Distributed Egress<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4_modulefour/43_centralizedegress.html><a class=padding href=../4_modulefour/43_centralizedegress.html>Centralized Egress<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4_modulefour/44_centralizedeastwest.html><a class=padding href=../4_modulefour/44_centralizedeastwest.html>Centralized East West<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5_modulefive.html><input type=checkbox id=section-eedb4ce2417d1c035ec50daff6810936 aria-controls=subsections-eedb4ce2417d1c035ec50daff6810936><label for=section-eedb4ce2417d1c035ec50daff6810936><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Extra Credit</span></label><a class=padding href=../5_modulefive.html>Extra Credit<i class="fas fa-check read-icon"></i></a><ul id=subsections-eedb4ce2417d1c035ec50daff6810936 class="morespace collapsible-menu"><li data-nav-id=/5_modulefive/51_task1.html><a class=padding href=../5_modulefive/51_task1.html>Task 1: Deploying CNF Instances and GWLBe endpoints<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5_modulefive/52_task2.html><a class=padding href=../5_modulefive/52_task2.html>Task 2: FortiManager Integration<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5_modulefive/53_task3.html><a class=padding href=../5_modulefive/53_task3.html>Task 3: FortiAnalyzer Integration<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6_modulesix.html><a class=padding href=../6_modulesix.html>Providing Feedback<i class="fas fa-check read-icon"></i></a></li></ul><div id=shortcuts><div class="nav-title padding">Helpful Resources</div><ul class=space><li><a class=padding href=https://fortinet.com/aws><i class='far fa-lightbulb'></i> Fortinet's AWS Microsite</a></li><li><a class=padding href="https://aws.amazon.com/marketplace/search/results?searchTerms=fortinet"><i class='fas fa-tools'></i> AWS MP Listings for Fortinet</a></li><li><a class=padding href=https://docs.fortinet.com/cloud-solutions/aws><i class='far fa-lightbulb'></i> Fortinet in AWS Docs</a></li><li><a class=padding href=https://docs.fortinet.com/product/fortigate-cnf><i class='fas fa-chalkboard-teacher'></i> FortiGate CNF Docs</a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><div class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-language>Language</label>
<select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></div></li><li id=select-variant-container class=footerVariantSwitch><div class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-variant>Theme</label>
<select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=Fortinet value=Fortinet selected>Fortinet</option></select></div><div class=select-clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><button class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i><span>&nbsp;</span>Clear History</button></li></ul></div><div id=footer class="footerFooter showFooter"><style>#footer{font-size:.8125rem;height:6.25rem;margin-left:auto;margin-right:auto;padding:2rem 1rem;text-align:center;min-width:14.375rem;max-width:18.75rem}#footer p{margin:0}</style><left><a href=https://www.fortinet.com/corporate/about-us/privacy target=_blank rel="noreferrer noopener">Privacy</a> | <a href=https://www.fortinet.com/corporate/about-us/legal target=_blank rel="noreferrer noopener">Site Terms</a> | <a href=https://www.fortinet.com/corporate/about-us/about-us target=_blank rel="noreferrer noopener">About Us</a></left></div></div></aside><script src=../js/clipboard.min.js?1684355376 defer></script>
<script src=../js/perfect-scrollbar.min.js?1684355376 defer></script>
<script src=../js/theme.js?1684355376 defer></script></body></html>