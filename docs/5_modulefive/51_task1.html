<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.111.3"><meta name=generator content="Relearn 5.12.6+tip"><meta name=description content="FortiGate CNF Workshop"><meta name=author content="Hiruy Aberra"><title>Task 1: Deploying CNF Instances and GWLBe endpoints - FortiGate CNF Workshop</title><link href=../5_modulefive/51_task1/index.xml rel=alternate type=application/rss+xml title="Task 1: Deploying CNF Instances and GWLBe endpoints - FortiGate CNF Workshop"><link rel=icon href=https://www.fortinet.com/etc/designs/fortinet/favicon.ico type=image/x-icon><link href=../css/fontawesome-all.min.css?1684355376 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fontawesome-all.min.css?1684355376 rel=stylesheet></noscript><link href=../css/nucleus.css?1684355376 rel=stylesheet><link href=../css/auto-complete.css?1684355376 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/auto-complete.css?1684355376 rel=stylesheet></noscript><link href=../css/perfect-scrollbar.min.css?1684355376 rel=stylesheet><link href=../css/fonts.css?1684355376 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fonts.css?1684355376 rel=stylesheet></noscript><link href=../css/theme.css?1684355376 rel=stylesheet><link href=../css/theme-Fortinet.css?1684355376 rel=stylesheet id=variant-style><link href=../css/variant.css?1684355376 rel=stylesheet><link href=../css/print.css?1684355376 rel=stylesheet media=print><link href=../css/ie.css?1684355376 rel=stylesheet><script src=../js/url.js?1684355376></script>
<script src=../js/variant.js?1684355376></script>
<script>window.index_json_url="../index.json",window.index_js_url="../index.search.js";var root_url="../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://fortinetcloudcse.github.io/FortiCNF/",window.variants&&variants.init(["Fortinet"])</script><style>@media screen and (min-width:1300px){#body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1300px;width:100%}}</style></head><body class="mobile-support html" data-url=../5_modulefive/51_task1.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next topbar-link" href=../5_modulefive/52_task2.html title="Task 2: FortiManager Integration (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev topbar-link" href=../5_modulefive.html title="Extra Credit (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle class=topbar-link title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../index.html><span itemprop=name>Secure AWS workloads with FortiGate CNF SaaS</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../5_modulefive.html><span itemprop=name>Extra Credit</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Task 1: Deploying CNF Instances and GWLBe endpoints</span><meta itemprop=position content="3"></li></ol></div></div></nav><main id=body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><div id=head-tags></div><article class="chapter deprecated"><h1 id=task-1-deploying-cnf-instances-and-gwlbe-endpoints>Task 1: Deploying CNF Instances and GWLBe endpoints</h1><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>For this section of the workshop we will be using the <strong>us-west-1 (N. California) region.</strong> There is a deployment of another Application VPC where FortiGate-CNF will inspect the ingress & egress traffic flows. Also there is a Management VPC where FortiAnalyzer, FortiManager, and a Nikto Scanner are deployed.</p></div></div><ul><li><ol><li>In the AWS CloudFormation console, make sure you are in the <strong>us-west-1 (N. California)</strong> region, then <strong>toggle the view nested button to off</strong> > then select the stack name > and on the details pane select the outputs tab. You should see the output for <strong>FortiAnalyzerLoginURL</strong>. <strong>Copy just the public IP</strong> as we will need this for the next step.</li></ol></li></ul><p><a href=#image-2fe200169227f19883dc21e9fdc1c056 class=lightbox-link><img src=../images/image-t6-2.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-2fe200169227f19883dc21e9fdc1c056><img src=../images/image-t6-2.png alt class=lightbox-image loading=lazy></a></p><ul><li><ol start=2><li>In the FortiGate CNF console, navigate to CNF instances and click <strong>New</strong>. Provide a name for the CNF instance, select <strong>us-west-1 (N. California)</strong> for the region, toggle <strong>FortiManager mode</strong> to on, select <strong>FortiAnalyzer</strong> for the log type and paste the public IP from the previous step. To save time, you can configure the GWLBe endpoints at the same time. In the Endpoints section, click the <strong>New</strong> button. Then you can select the account, VPC, then toggle the <strong>Select from all subnets to off</strong> (this filters the subnets to only show ones that are properly tagged), and the subnet to deploy the VPC endpoint to. Repeat this step for all subnets in the table below, then click the <strong>Next</strong> button. Once all have been created, click <strong>OK</strong>.</li></ol></li></ul><table><thead><tr><th>VPC</th><th>Subnet</th></tr></thead><tbody><tr><td>Application-VPC</td><td>Application-GwlbeSubnet1</td></tr><tr><td>Application-VPC</td><td>Application-GwlbeSubnet2</td></tr></tbody></table><p><a href=#image-e4ba05ff3eba8166d296cfa0847f46c6 class=lightbox-link><img src=../images/image-t6-3.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-e4ba05ff3eba8166d296cfa0847f46c6><img src=../images/image-t6-3.png alt class=lightbox-image loading=lazy></a></p><ul><li><ol start=3><li>The CNF Instance should show up as <strong>active after roughly 10 minutes</strong> (Now is a great time for a break :) ). The endpoints will be deployed at this point.</li></ol></li></ul><p><a href=#image-70afc2d817b24e2194f76ef172b888b5 class=lightbox-link><img src=../images/image-t6-4.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-70afc2d817b24e2194f76ef172b888b5><img src=../images/image-t6-4.png alt class=lightbox-image loading=lazy></a></p><ul><li><ol start=4><li>To validate all GWLBe endpoints have been deployed and are active (takes ~5 mins), <strong>select and edit</strong> the CNF instance and click <strong>Next</strong> to view the GWLBe endpoints on the Configure Endpoints section of the wizard. Then click <strong>Exit</strong> to leave the CNF configuration wizard.</li></ol></li></ul><p><a href=#image-462c95940e1665ac2ee1d799fc37992b class=lightbox-link><img src=../images/image-t6-5.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-462c95940e1665ac2ee1d799fc37992b><img src=../images/image-t6-5.png alt class=lightbox-image loading=lazy></a></p><ul><li><ol start=5><li>Log into your AWS Account and navigate to the <strong>VPC Console > Endpoints</strong>. Each of the GWLBe endpoints you deployed in the FortiGate CNF Console should be visible in your account. Notice the tag name and value pairs assigned to the endpoints.</li></ol></li></ul><p><a href=#image-1c5b02693e73a5f5b358db2ea8488940 class=lightbox-link><img src=../images/image-t6-6.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-1c5b02693e73a5f5b358db2ea8488940><img src=../images/image-t6-6.png alt class=lightbox-image loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p><strong>Note:</strong> At this point in a normal environment, you would need to create ingress and VPC routes to direct traffic to the GWLBe endpoints that were created by FortiGate CNF for inspection. However, for this workshop there is a Lambda function that is creating these routes for you to match the AWS Reference Architecture Diagram.</p></div></div><ul><li><ol start=6><li>To validate that the relevant VPC routes have been automatically created to route traffic to the GWLBe endpoints, in the AWS VPC console, <strong>navigate to Virtual Private Cloud > Route Tables</strong>, select each of the route tables listed below and confirm these routes exist in the route tab of the route table details pane.</li></ol></li></ul><table><thead><tr><th>VPC Route Table</th><th># Routes to GLWBe</th></tr></thead><tbody><tr><td>Application-IgwRouteTable</td><td>2x (one per public subnet), one per GWLBe (each AZ)</td></tr><tr><td>Application-Public1RouteTable</td><td>1x (default route), GWLBe AZ1</td></tr><tr><td>Application-Public2RouteTable</td><td>1x (default route), GWLBe AZ2</td></tr></tbody></table><p><a href=#image-3c83f9c82ccb612b306afc2ac8a7f4da class=lightbox-link><img src=../images/image-t6-7.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-3c83f9c82ccb612b306afc2ac8a7f4da><img src=../images/image-t6-7.png alt class=lightbox-image loading=lazy></a></p><ul><li><ol start=7><li>To confirm that app1 in the Application VPC is reachable, in the AWS CloudFormation console, <strong>toggle the view nested button to off</strong> > then select the stack name > and on the details pane select the outputs tab. You should see the output for <strong>URLforApp1</strong>. Click on the value for that output to check that App1 is reachable now. You should see a simple webpage with some metadata about the backend web server instance that is reachable via the public Network Load Balancer (NLB).</li></ol></li></ul><p><a href=#image-cd2b04370ba08dbaa0414e38a26d54d7 class=lightbox-link><img src=../images/image-t6-8.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-cd2b04370ba08dbaa0414e38a26d54d7><img src=../images/image-t6-8.png alt class=lightbox-image loading=lazy></a></p><p><a href=#image-7207fafad5819780d990697aece41bf4 class=lightbox-link><img src=../images/image-t6-9.png alt style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-7207fafad5819780d990697aece41bf4><img src=../images/image-t6-9.png alt class=lightbox-image loading=lazy></a></p><ul><li><ol start=8><li>This concludes this section.</li></ol></li></ul><footer class=footline></footer></article></div></main></div><aside id=sidebar class="default-animation showVisitedLinks"><div id=header-wrapper class=default-animation><div id=header class=default-animation><a href=../ title="Fortinet Demos"><img style=vertical-align:middle src=../Fortinet-logo-rgb-white-red.svg height=70px></a></div><form action=../search.html method=get><div class="searchbox default-animation"><button type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=search-by>Search</label>
<input data-search-input id=search-by name=search-by class=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div></form><script>var contentLangs=["en"]</script><script src=../js/auto-complete.js?1684355376 defer></script>
<script src=../js/lunr/lunr.min.js?1684355376 defer></script>
<script src=../js/lunr/lunr.stemmer.support.min.js?1684355376 defer></script>
<script src=../js/lunr/lunr.multi.min.js?1684355376 defer></script>
<script src=../js/lunr/lunr.en.min.js?1684355376 defer></script>
<script src=../js/search.js?1684355376 defer></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=../index.html><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class="topics enlarge morespace collapsible-menu"><li data-nav-id=/1_moduleone.html><a class=padding href=../1_moduleone.html>Introduction<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo.html><input type=checkbox id=section-6180d618e477c4171cc9d7ced5bb0928 aria-controls=subsections-6180d618e477c4171cc9d7ced5bb0928><label for=section-6180d618e477c4171cc9d7ced5bb0928><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Workshop Prerequisites</span></label><a class=padding href=../2_moduletwo.html>Workshop Prerequisites<i class="fas fa-check read-icon"></i></a><ul id=subsections-6180d618e477c4171cc9d7ced5bb0928 class="morespace collapsible-menu"><li data-nav-id=/2_moduletwo/21_logistics.html><a class=padding href=../2_moduletwo/21_logistics.html>Workshop Logistics<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo/22_awsnetworkingconcepts.html><a class=padding href=../2_moduletwo/22_awsnetworkingconcepts.html>AWS Networking Concepts<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo/23_awscommonarchitecturepatterns.html><a class=padding href=../2_moduletwo/23_awscommonarchitecturepatterns.html>AWS Common Architecture Patterns<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/2_moduletwo/24_fortigatecnfterminology.html><a class=padding href=../2_moduletwo/24_fortigatecnfterminology.html>FortiGate CNF Terminology<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/3_modulethree.html><input type=checkbox id=section-787a272b0074b57237733dd429c6920c aria-controls=subsections-787a272b0074b57237733dd429c6920c><label for=section-787a272b0074b57237733dd429c6920c><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Workshop Hands On</span></label><a class=padding href=../3_modulethree.html>Workshop Hands On<i class="fas fa-check read-icon"></i></a><ul id=subsections-787a272b0074b57237733dd429c6920c class="morespace collapsible-menu"><li data-nav-id=/3_modulethree/31_task1.html><a class=padding href=../3_modulethree/31_task1.html>Task 1: Subscribe to FortiGate CNF in AWS Marketplace<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/32_task2.html><a class=padding href=../3_modulethree/32_task2.html>Task 2: Onboard an AWS account to FortiGate CNF<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/33_task3.html><a class=padding href=../3_modulethree/33_task3.html>Task 3: Deploying CNF Instances and GWLBe endpoints<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/34_task4.html><a class=padding href=../3_modulethree/34_task4.html>Task 4: Create a policy set and apply it to a FortiGate CNF Instance<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3_modulethree/35_task5.html><a class=padding href=../3_modulethree/35_task5.html>Task 5: Validate Resolution of Dynamic Address Objects<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4_modulefour.html><input type=checkbox id=section-e0da539b16e47ab0661df6a76b214530 aria-controls=subsections-e0da539b16e47ab0661df6a76b214530><label for=section-e0da539b16e47ab0661df6a76b214530><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Workshop Test Traffic</span></label><a class=padding href=../4_modulefour.html>Workshop Test Traffic<i class="fas fa-check read-icon"></i></a><ul id=subsections-e0da539b16e47ab0661df6a76b214530 class="morespace collapsible-menu"><li data-nav-id=/4_modulefour/41_distributedingress.html><a class=padding href=../4_modulefour/41_distributedingress.html>Distributed Ingress<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4_modulefour/42_distributedegress.html><a class=padding href=../4_modulefour/42_distributedegress.html>Distributed Egress<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4_modulefour/43_centralizedegress.html><a class=padding href=../4_modulefour/43_centralizedegress.html>Centralized Egress<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4_modulefour/44_centralizedeastwest.html><a class=padding href=../4_modulefour/44_centralizedeastwest.html>Centralized East West<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5_modulefive.html class=parent><input type=checkbox id=section-eedb4ce2417d1c035ec50daff6810936 aria-controls=subsections-eedb4ce2417d1c035ec50daff6810936 checked><label for=section-eedb4ce2417d1c035ec50daff6810936><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class=a11y-only>Submenu Extra Credit</span></label><a class=padding href=../5_modulefive.html>Extra Credit<i class="fas fa-check read-icon"></i></a><ul id=subsections-eedb4ce2417d1c035ec50daff6810936 class="morespace collapsible-menu"><li data-nav-id=/5_modulefive/51_task1.html class=active><a class=padding href=../5_modulefive/51_task1.html>Task 1: Deploying CNF Instances and GWLBe endpoints<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5_modulefive/52_task2.html><a class=padding href=../5_modulefive/52_task2.html>Task 2: FortiManager Integration<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5_modulefive/53_task3.html><a class=padding href=../5_modulefive/53_task3.html>Task 3: FortiAnalyzer Integration<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6_modulesix.html><a class=padding href=../6_modulesix.html>Providing Feedback<i class="fas fa-check read-icon"></i></a></li></ul><div id=shortcuts><div class="nav-title padding">Helpful Resources</div><ul class=space><li><a class=padding href=https://fortinet.com/aws><i class='far fa-lightbulb'></i> Fortinet's AWS Microsite</a></li><li><a class=padding href="https://aws.amazon.com/marketplace/search/results?searchTerms=fortinet"><i class='fas fa-tools'></i> AWS MP Listings for Fortinet</a></li><li><a class=padding href=https://docs.fortinet.com/cloud-solutions/aws><i class='far fa-lightbulb'></i> Fortinet in AWS Docs</a></li><li><a class=padding href=https://docs.fortinet.com/product/fortigate-cnf><i class='fas fa-chalkboard-teacher'></i> FortiGate CNF Docs</a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><div class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-language>Language</label>
<select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></div></li><li id=select-variant-container class=footerVariantSwitch><div class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-variant>Theme</label>
<select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=Fortinet value=Fortinet selected>Fortinet</option></select></div><div class=select-clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><button class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i><span>&nbsp;</span>Clear History</button></li></ul></div><div id=footer class="footerFooter showFooter"><style>#footer{font-size:.8125rem;height:6.25rem;margin-left:auto;margin-right:auto;padding:2rem 1rem;text-align:center;min-width:14.375rem;max-width:18.75rem}#footer p{margin:0}</style><left><a href=https://www.fortinet.com/corporate/about-us/privacy target=_blank rel="noreferrer noopener">Privacy</a> | <a href=https://www.fortinet.com/corporate/about-us/legal target=_blank rel="noreferrer noopener">Site Terms</a> | <a href=https://www.fortinet.com/corporate/about-us/about-us target=_blank rel="noreferrer noopener">About Us</a></left></div></div></aside><script src=../js/clipboard.min.js?1684355376 defer></script>
<script src=../js/perfect-scrollbar.min.js?1684355376 defer></script>
<script src=../js/theme.js?1684355376 defer></script></body></html>